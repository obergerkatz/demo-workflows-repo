name: Manual Slack Deployment Notification

on:
  workflow_dispatch:

jobs:
  notify-deployment:
    name: Notify Slack of deployment
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Send Slack message with blocks - success status
        uses: ./actions/slack/send-workflow-status
        with:
          token: ${{ secrets.SLACK_BOT_TOKEN }}
          channel: ${{ secrets.SLACK_CHANNEL_ID }}
          text: "Deployment to prod completed successfully!"
          tag: 'berger-${{ github.sha }}'
          env: 'qa'
          status: 'success'

      - name: Send Slack message with blocks - ongoing status
        uses: ./actions/slack/send-workflow-status
        with:
          token: ${{ secrets.SLACK_BOT_TOKEN }}
          channel: ${{ secrets.SLACK_CHANNEL_ID }}
          text: "Deployment to prod completed successfully!"
          tag: 'berger-${{ github.sha }}'
          env: 'qa'
          status: 'ongoing'

      - name: Send Slack message with blocks - failed status
        uses: ./actions/slack/send-workflow-status
        with:
          token: ${{ secrets.SLACK_BOT_TOKEN }}
          channel: ${{ secrets.SLACK_CHANNEL_ID }}
          text: "Deployment to prod completed successfully!"
          tag: 'berger-${{ github.sha }}'
          env: 'qa'
          status: 'failed'